{"version":3,"sources":["scripts/content-script.js"],"names":["onHashChange","console","log","isCreatePage","event","Event","createButton","on","setTimeout","bind","this","shareThisEvent","modal","shareModal","iziModal","padding","setValues","data","text","toText","loadModal","$","get","chrome","extension","getURL","popup","body","append","checkFacebookLoginState","handleModalButtons","off","window","open","twitterUrl","toLink","windowOptions","confirmPostToFacebook","gplusUrl","location","hash","match","query","$title","$location","datetime","isAllDay","is","value","title","encodeURIComponent","facebookUrl","outerWidth","outerHeight","addEventListener","document","attr"],"mappings":"AAAA,YAuDA,SAASA,gBAGP,GAFAC,QAAQC,IAAI,gBAEPC,eAAL,CAEAF,QAAQC,IAAI,iBAEZ,IAAIE,GAAQC,OAEZC,gBAAeC,GAAG,QAASC,WAAWC,KAAKC,KAAMC,eAAeF,KAAKC,KAAMN,GAAQ,OAGrF,QAASO,gBAAeP,GAGtB,GAAIQ,GAAQC,aAAaC,UACvBC,QAAS,IAGXV,OAAMW,UAAUZ,GAChBQ,EAAMK,KAAK,QAASb,GAEpBS,WAAW,QAAQK,KAAKb,MAAMc,OAAOf,IAErCQ,EAAME,SAAS,QAGjB,QAASM,aACPC,EAAEC,IAAIC,OAAOC,UAAUC,OAAO,2BAA4B,SAAUC,GAClEC,OAAOC,OAAOF,GACdG,4BAIJ,QAASC,sBACP,GAAI1B,GAAQS,aAAaI,KAAK,QAE9BJ,YAAW,SAASK,KAAK,IAAMb,MAAMc,OAAOf,GAAS,KAErDS,WAAW,YAAYkB,IAAI,SAASxB,GAAG,QAAS,WAC9CyB,OAAOC,KAAKC,WAAa7B,MAAM8B,OAAO/B,GAAQ,GAAIgC,iBAEpDvB,WAAW,aAAakB,IAAI,SAASxB,GAAG,QAAS,WAC/C8B,sBAAsBhC,MAAOD,KAE/BS,WAAW,UAAUkB,IAAI,SAASxB,GAAG,QAAS,WAC5CyB,OAAOC,KAAKK,SAAU,GAAIF,iBAjG9B,GAAIjC,cAAe,WACjB,MAAOoC,UAASC,KAAKC,MAAM,kBAEzBnC,aAAe,WACjB,MAAOe,GAAE,qDAEPM,KAAO,WACT,MAAON,GAAE,SAEPR,WAAa,SAAoB6B,GACnC,MAAOrB,GAAE,wCAA0CqB,GAAS,MAI1DrC,MAAQ,WACV,OACEsC,OAAQtB,EAAE,gCAAgC,GAC1CuB,UAAWvB,EAAE,gCAAgC,GAC7CwB,SAAUxB,EAAE,sCACZyB,SAAU,WACR,MAAOzB,GAAE,0CAA0C0B,GAAG,cAI5D1C,OAAMc,OAAS,SAAUf,GACvB,GAAIyC,GAAWzC,EAAMyC,SAAS,GAAGG,KAGjC,OAFK5C,GAAM0C,aAAYD,GAAY,IAAMzC,EAAMyC,SAAS,GAAGG,OAEpD,MAAQH,EAAW,KAAOzC,EAAM6C,MAAQ,OAAS7C,EAAMmC,UAEhElC,MAAM8B,OAAS,SAAU/B,GACvB,MAAO8C,oBAAmB7C,MAAMc,OAAOf,KAEzCC,MAAMW,UAAY,SAAUZ,GAC1BA,EAAM6C,MAAQ7C,EAAMuC,OAAOK,MAC3B5C,EAAMmC,SAAWnC,EAAMwC,UAAUI,MAInC,IAAId,YAAa,yCACbiB,YAAc,2EACdb,SAAW,gEACXF,cAAgB,+BAAiCJ,OAAOoB,WAAa,KAAO,EAAI,UAAYpB,OAAOqB,YAAc,KAAO,GAG5HrB,QAAOsB,iBAAiB,aAActD,cAAc,GAEpDA,eACAoB,YAqDAC,EAAEkC,UAAUhD,GAAG,SAAUM,aAAa2C,KAAK,MAAO1B","file":"scripts/content-script.js","sourcesContent":["'use strict';\n\n// ---- jquery util\n\nvar isCreatePage = function isCreatePage() {\n  return location.hash.match(/^#eventpage_6/);\n};\nvar createButton = function createButton() {\n  return $('#maincell .action-btn-wrapper div[role=\"button\"]');\n};\nvar body = function body() {\n  return $('body');\n};\nvar shareModal = function shareModal(query) {\n  return $('#socialcalendarextension-share-modal' + (query || ''));\n};\n\n// used as `let event = Event(); let title = event.title.value;`\nvar Event = function Event() {\n  return {\n    $title: $('#maincell input[type=\"text\"]')[0],\n    $location: $('#maincell input[type=\"text\"]')[1],\n    datetime: $('#maincell .ep-edr-first-line input'),\n    isAllDay: function isAllDay() {\n      return $('#maincell input[type=\"checkbox\"]:first').is(':checked');\n    }\n  };\n};\nEvent.toText = function (event) {\n  var datetime = event.datetime[0].value;\n  if (!event.isAllDay()) datetime += ' ' + event.datetime[1].value;\n\n  return 'In ' + datetime + ', ' + event.title + ' at ' + event.location;\n};\nEvent.toLink = function (event) {\n  return encodeURIComponent(Event.toText(event));\n};\nEvent.setValues = function (event) {\n  event.title = event.$title.value;\n  event.location = event.$location.value;\n};\n\n// ---- sharee options\nvar twitterUrl = 'https://twitter.com/intent/tweet?text=';\nvar facebookUrl = 'https://www.facebook.com/sharer/sharer.php?u=https://calendar.google.com';\nvar gplusUrl = 'https://plus.google.com/share?url=https://calendar.google.com';\nvar windowOptions = 'width=500, height=500,left=' + (window.outerWidth - 500) / 2 + ', top=' + (window.outerHeight - 500) / 2.5;\n\n// ---- setup\nwindow.addEventListener('hashchange', onHashChange, false);\n\nonHashChange();\nloadModal();\n\n// ---- logic\nfunction onHashChange() {\n  console.log('hash changed');\n\n  if (!isCreatePage()) return;\n\n  console.log('is create page');\n\n  var event = Event();\n\n  createButton().on('click', setTimeout.bind(this, shareThisEvent.bind(this, event), 800));\n}\n\nfunction shareThisEvent(event) {\n  // window.open(twitterUrl + Event.toLink(event), '', windowOptions);\n\n  var modal = shareModal().iziModal({\n    padding: 20\n  });\n\n  Event.setValues(event);\n  modal.data('event', event);\n\n  shareModal('text').text(Event.toText(event));\n\n  modal.iziModal('open');\n}\n\nfunction loadModal() {\n  $.get(chrome.extension.getURL('/views/share-popup.html'), function (popup) {\n    body().append(popup);\n    checkFacebookLoginState();\n  });\n}\n\nfunction handleModalButtons() {\n  var event = shareModal().data('event');\n\n  shareModal('-text').text('\"' + Event.toText(event) + '\"');\n\n  shareModal('-twitter').off('click').on('click', function () {\n    window.open(twitterUrl + Event.toLink(event), '', windowOptions);\n  });\n  shareModal('-facebook').off('click').on('click', function () {\n    confirmPostToFacebook(Event, event);\n  });\n  shareModal('-gplus').off('click').on('click', function () {\n    window.open(gplusUrl, '', windowOptions);\n  });\n}\n\n$(document).on('opened', shareModal().attr('id'), handleModalButtons);"],"sourceRoot":"/source/"}