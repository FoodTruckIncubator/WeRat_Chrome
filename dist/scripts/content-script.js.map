{"version":3,"sources":["scripts/content-script.js"],"names":["onHashChange","console","log","isCreatePage","event","Event","createButton","on","setTimeout","bind","this","shareThisEvent","modal","shareModal","iziModal","padding","setValues","data","text","toText","loadModal","$","get","chrome","extension","getURL","popup","body","append","checkFacebookLoginStateOnly","handleModalButtons","off","window","open","twitterUrl","toLink","windowOptions","tryPostAtFacebook","gplusUrl","imageUrl","tryPostAtFoursquare","location","hash","match","query","$title","$location","$datetime","datetime","date","isAllDay","time","title","encodeURIComponent","value","is","facebookUrl","url","outerWidth","outerHeight","addEventListener","document","attr"],"mappings":"AAAA,YAkEA,SAASA,gBAGP,GAFAC,QAAQC,IAAI,gBAEPC,eAAL,CAEAF,QAAQC,IAAI,iBAEZ,IAAIE,GAAQC,OAEZC,gBAAeC,GAAG,QAASC,WAAWC,KAAKC,KAAMC,eAAeF,KAAKC,KAAMN,GAAQ,OAGrF,QAASO,gBAAeP,GAGtB,GAAIQ,GAAQC,aAAaC,UACvBC,QAAS,IAGXV,OAAMW,UAAUZ,GAChBQ,EAAMK,KAAK,QAASb,GAEpBS,WAAW,QAAQK,KAAKb,MAAMc,OAAOf,IAErCQ,EAAME,SAAS,QAGjB,QAASM,aACPC,EAAEC,IAAIC,OAAOC,UAAUC,OAAO,2BAA4B,SAAUC,GAClEC,OAAOC,OAAOF,GACdG,gCAIJ,QAASC,sBACP,GAAI1B,GAAQS,aAAaI,KAAK,QAE9BJ,YAAW,SAASK,KAAK,IAAMb,MAAMc,OAAOf,GAAS,KAErDS,WAAW,YAAYkB,IAAI,SAASxB,GAAG,QAAS,WAC9CyB,OAAOC,KAAKC,WAAa7B,MAAM8B,OAAO/B,GAAQ,GAAIgC,iBAEpDvB,WAAW,aAAakB,IAAI,SAASxB,GAAG,QAAS,WAC/C8B,kBAAkBhC,MAAOD,KAE3BS,WAAW,UAAUkB,IAAI,SAASxB,GAAG,QAAS,WAC5CyB,OAAOC,KAAKK,SAASjC,MAAMkC,SAASnC,IAAS,GAAIgC,iBAEnDvB,WAAW,eAAekB,IAAI,SAASxB,GAAG,QAAS,WACjDiC,oBAAoBnC,MAAOD,KA/G/B,GAAID,cAAe,WACjB,MAAOsC,UAASC,KAAKC,MAAM,kBAEzBrC,aAAe,WACjB,MAAOe,GAAE,qDAEPM,KAAO,WACT,MAAON,GAAE,SAEPR,WAAa,SAAoB+B,GACnC,MAAOvB,GAAE,wCAA0CuB,GAAS,MAI1DvC,MAAQ,WACV,OACEwC,OAAQxB,EAAE,gCAAgC,GAC1CyB,UAAWzB,EAAE,gCAAgC,GAC7C0B,UAAW1B,EAAE,uCAIjBhB,OAAMkC,SAAW,SAAUnC,GACzB,MAAO,qGAAuGC,MAAM8B,OAAO/B,IAG7HC,MAAMc,OAAS,SAAUf,GACvB,GAAI4C,GAAW5C,EAAM6C,IAGrB,OAFK7C,GAAM8C,WAAUF,GAAY,IAAM5C,EAAM+C,MAEtC,MAAQH,EAAW,KAAO5C,EAAMgD,MAAQ,OAAShD,EAAMqC,UAGhEpC,MAAM8B,OAAS,SAAU/B,GACvB,MAAOiD,oBAAmBhD,MAAMc,OAAOf,KAGzCC,MAAMW,UAAY,SAAUZ,GAC1BA,EAAMgD,MAAQhD,EAAMyC,OAAOS,MAC3BlD,EAAMqC,SAAWrC,EAAM0C,UAAUQ,MAEjClD,EAAM6C,KAAO7C,EAAM2C,UAAU,GAAGO,MAChClD,EAAM+C,KAAO/C,EAAM2C,UAAU,GAAGO,MAEhClD,EAAM8C,SAAW7B,EAAE,0CAA0CkC,GAAG,YAIlE,IAAIrB,YAAa,yCACbsB,YAAc,2EACdlB,SAAW,SAAkBmB,GAC/B,MAAO,qCAAuCJ,mBAAmBI,IAE/DrB,cAAgB,+BAAiCJ,OAAO0B,WAAa,KAAO,EAAI,UAAY1B,OAAO2B,YAAc,KAAO,GAG5H3B,QAAO4B,iBAAiB,aAAc5D,cAAc,GAEpDA,eACAoB,YAwDAC,EAAEwC,UAAUtD,GAAG,SAAUM,aAAaiD,KAAK,MAAOhC","file":"scripts/content-script.js","sourcesContent":["'use strict';\n\n// ---- jquery util\n\nvar isCreatePage = function isCreatePage() {\n  return location.hash.match(/^#eventpage_6/);\n};\nvar createButton = function createButton() {\n  return $('#maincell .action-btn-wrapper div[role=\"button\"]');\n};\nvar body = function body() {\n  return $('body');\n};\nvar shareModal = function shareModal(query) {\n  return $('#socialcalendarextension-share-modal' + (query || ''));\n};\n\n// used as `let event = Event(); let title = event.title.value;`\nvar Event = function Event() {\n  return {\n    $title: $('#maincell input[type=\"text\"]')[0],\n    $location: $('#maincell input[type=\"text\"]')[1],\n    $datetime: $('#maincell .ep-edr-first-line input')\n  };\n};\n\nEvent.imageUrl = function (event) {\n  return 'https://placeholdit.imgix.net/~text?txtsize=33&bg=bbbbbb&txtclr=666666&w=400&h=300&txttrack=0&txt=' + Event.toLink(event);\n};\n\nEvent.toText = function (event) {\n  var datetime = event.date;\n  if (!event.isAllDay) datetime += ' ' + event.time;\n\n  return 'In ' + datetime + ', ' + event.title + ' at ' + event.location;\n};\n\nEvent.toLink = function (event) {\n  return encodeURIComponent(Event.toText(event));\n};\n\nEvent.setValues = function (event) {\n  event.title = event.$title.value;\n  event.location = event.$location.value;\n\n  event.date = event.$datetime[0].value;\n  event.time = event.$datetime[1].value;\n\n  event.isAllDay = $('#maincell input[type=\"checkbox\"]:first').is(':checked');\n};\n\n// ---- sharee options\nvar twitterUrl = 'https://twitter.com/intent/tweet?text=';\nvar facebookUrl = 'https://www.facebook.com/sharer/sharer.php?u=https://calendar.google.com';\nvar gplusUrl = function gplusUrl(url) {\n  return 'https://plus.google.com/share?url=' + encodeURIComponent(url);\n};\nvar windowOptions = 'width=500, height=500,left=' + (window.outerWidth - 500) / 2 + ', top=' + (window.outerHeight - 500) / 2.5;\n\n// ---- setup\nwindow.addEventListener('hashchange', onHashChange, false);\n\nonHashChange();\nloadModal();\n\n// ---- logic\nfunction onHashChange() {\n  console.log('hash changed');\n\n  if (!isCreatePage()) return;\n\n  console.log('is create page');\n\n  var event = Event();\n\n  createButton().on('click', setTimeout.bind(this, shareThisEvent.bind(this, event), 800));\n}\n\nfunction shareThisEvent(event) {\n  // window.open(twitterUrl + Event.toLink(event), '', windowOptions);\n\n  var modal = shareModal().iziModal({\n    padding: 20\n  });\n\n  Event.setValues(event);\n  modal.data('event', event);\n\n  shareModal('text').text(Event.toText(event));\n\n  modal.iziModal('open');\n}\n\nfunction loadModal() {\n  $.get(chrome.extension.getURL('/views/share-popup.html'), function (popup) {\n    body().append(popup);\n    checkFacebookLoginStateOnly();\n  });\n}\n\nfunction handleModalButtons() {\n  var event = shareModal().data('event');\n\n  shareModal('-text').text('\"' + Event.toText(event) + '\"');\n\n  shareModal('-twitter').off('click').on('click', function () {\n    window.open(twitterUrl + Event.toLink(event), '', windowOptions);\n  });\n  shareModal('-facebook').off('click').on('click', function () {\n    tryPostAtFacebook(Event, event);\n  });\n  shareModal('-gplus').off('click').on('click', function () {\n    window.open(gplusUrl(Event.imageUrl(event)), '', windowOptions);\n  });\n  shareModal('-foursquare').off('click').on('click', function () {\n    tryPostAtFoursquare(Event, event);\n  });\n}\n\n$(document).on('opened', shareModal().attr('id'), handleModalButtons);"],"sourceRoot":"/source/"}