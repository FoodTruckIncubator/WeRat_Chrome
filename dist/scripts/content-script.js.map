{"version":3,"sources":["scripts/content-script.js"],"names":["onHashChange","console","log","isCreatePage","event","Event","createButton","on","setTimeout","bind","this","shareThisEvent","modal","shareModal","iziModal","padding","setValues","data","text","toText","loadModal","$","get","chrome","extension","getURL","popup","body","append","checkFacebookLoginState","handleModalButtons","off","window","open","twitterUrl","toLink","windowOptions","confirmPostToFacebook","gplusUrl","imageUrl","location","hash","match","query","$title","$location","datetime","isAllDay","is","value","title","encodeURIComponent","facebookUrl","url","outerWidth","outerHeight","addEventListener","document","attr"],"mappings":"AAAA,YAgEA,SAASA,gBAGP,GAFAC,QAAQC,IAAI,gBAEPC,eAAL,CAEAF,QAAQC,IAAI,iBAEZ,IAAIE,GAAQC,OAEZC,gBAAeC,GAAG,QAASC,WAAWC,KAAKC,KAAMC,eAAeF,KAAKC,KAAMN,GAAQ,OAGrF,QAASO,gBAAeP,GAGtB,GAAIQ,GAAQC,aAAaC,UACvBC,QAAS,IAGXV,OAAMW,UAAUZ,GAChBQ,EAAMK,KAAK,QAASb,GAEpBS,WAAW,QAAQK,KAAKb,MAAMc,OAAOf,IAErCQ,EAAME,SAAS,QAGjB,QAASM,aACPC,EAAEC,IAAIC,OAAOC,UAAUC,OAAO,2BAA4B,SAAUC,GAClEC,OAAOC,OAAOF,GACdG,4BAIJ,QAASC,sBACP,GAAI1B,GAAQS,aAAaI,KAAK,QAE9BJ,YAAW,SAASK,KAAK,IAAMb,MAAMc,OAAOf,GAAS,KAErDS,WAAW,YAAYkB,IAAI,SAASxB,GAAG,QAAS,WAC9CyB,OAAOC,KAAKC,WAAa7B,MAAM8B,OAAO/B,GAAQ,GAAIgC,iBAEpDvB,WAAW,aAAakB,IAAI,SAASxB,GAAG,QAAS,WAC/C8B,sBAAsBhC,MAAOD,KAE/BS,WAAW,UAAUkB,IAAI,SAASxB,GAAG,QAAS,WAC5CyB,OAAOC,KAAKK,SAASjC,MAAMkC,SAASnC,IAAS,GAAIgC,iBA1GrD,GAAIjC,cAAe,WACjB,MAAOqC,UAASC,KAAKC,MAAM,kBAEzBpC,aAAe,WACjB,MAAOe,GAAE,qDAEPM,KAAO,WACT,MAAON,GAAE,SAEPR,WAAa,SAAoB8B,GACnC,MAAOtB,GAAE,wCAA0CsB,GAAS,MAI1DtC,MAAQ,WACV,OACEuC,OAAQvB,EAAE,gCAAgC,GAC1CwB,UAAWxB,EAAE,gCAAgC,GAC7CyB,SAAUzB,EAAE,sCACZ0B,SAAU,WACR,MAAO1B,GAAE,0CAA0C2B,GAAG,cAK5D3C,OAAMkC,SAAW,SAAUnC,GACzB,MAAO,qGAAuGC,MAAM8B,OAAO/B,IAG7HC,MAAMc,OAAS,SAAUf,GACvB,GAAI0C,GAAW1C,EAAM0C,SAAS,GAAGG,KAGjC,OAFK7C,GAAM2C,aAAYD,GAAY,IAAM1C,EAAM0C,SAAS,GAAGG,OAEpD,MAAQH,EAAW,KAAO1C,EAAM8C,MAAQ,OAAS9C,EAAMoC,UAGhEnC,MAAM8B,OAAS,SAAU/B,GACvB,MAAO+C,oBAAmB9C,MAAMc,OAAOf,KAGzCC,MAAMW,UAAY,SAAUZ,GAC1BA,EAAM8C,MAAQ9C,EAAMwC,OAAOK,MAC3B7C,EAAMoC,SAAWpC,EAAMyC,UAAUI,MAInC,IAAIf,YAAa,yCACbkB,YAAc,2EACdd,SAAW,SAAkBe,GAC/B,MAAO,qCAAuCF,mBAAmBE,IAE/DjB,cAAgB,+BAAiCJ,OAAOsB,WAAa,KAAO,EAAI,UAAYtB,OAAOuB,YAAc,KAAO,GAG5HvB,QAAOwB,iBAAiB,aAAcxD,cAAc,GAEpDA,eACAoB,YAqDAC,EAAEoC,UAAUlD,GAAG,SAAUM,aAAa6C,KAAK,MAAO5B","file":"scripts/content-script.js","sourcesContent":["'use strict';\n\n// ---- jquery util\n\nvar isCreatePage = function isCreatePage() {\n  return location.hash.match(/^#eventpage_6/);\n};\nvar createButton = function createButton() {\n  return $('#maincell .action-btn-wrapper div[role=\"button\"]');\n};\nvar body = function body() {\n  return $('body');\n};\nvar shareModal = function shareModal(query) {\n  return $('#socialcalendarextension-share-modal' + (query || ''));\n};\n\n// used as `let event = Event(); let title = event.title.value;`\nvar Event = function Event() {\n  return {\n    $title: $('#maincell input[type=\"text\"]')[0],\n    $location: $('#maincell input[type=\"text\"]')[1],\n    datetime: $('#maincell .ep-edr-first-line input'),\n    isAllDay: function isAllDay() {\n      return $('#maincell input[type=\"checkbox\"]:first').is(':checked');\n    }\n  };\n};\n\nEvent.imageUrl = function (event) {\n  return 'https://placeholdit.imgix.net/~text?txtsize=33&bg=bbbbbb&txtclr=666666&w=400&h=300&txttrack=0&txt=' + Event.toLink(event);\n};\n\nEvent.toText = function (event) {\n  var datetime = event.datetime[0].value;\n  if (!event.isAllDay()) datetime += ' ' + event.datetime[1].value;\n\n  return 'In ' + datetime + ', ' + event.title + ' at ' + event.location;\n};\n\nEvent.toLink = function (event) {\n  return encodeURIComponent(Event.toText(event));\n};\n\nEvent.setValues = function (event) {\n  event.title = event.$title.value;\n  event.location = event.$location.value;\n};\n\n// ---- sharee options\nvar twitterUrl = 'https://twitter.com/intent/tweet?text=';\nvar facebookUrl = 'https://www.facebook.com/sharer/sharer.php?u=https://calendar.google.com';\nvar gplusUrl = function gplusUrl(url) {\n  return 'https://plus.google.com/share?url=' + encodeURIComponent(url);\n};\nvar windowOptions = 'width=500, height=500,left=' + (window.outerWidth - 500) / 2 + ', top=' + (window.outerHeight - 500) / 2.5;\n\n// ---- setup\nwindow.addEventListener('hashchange', onHashChange, false);\n\nonHashChange();\nloadModal();\n\n// ---- logic\nfunction onHashChange() {\n  console.log('hash changed');\n\n  if (!isCreatePage()) return;\n\n  console.log('is create page');\n\n  var event = Event();\n\n  createButton().on('click', setTimeout.bind(this, shareThisEvent.bind(this, event), 800));\n}\n\nfunction shareThisEvent(event) {\n  // window.open(twitterUrl + Event.toLink(event), '', windowOptions);\n\n  var modal = shareModal().iziModal({\n    padding: 20\n  });\n\n  Event.setValues(event);\n  modal.data('event', event);\n\n  shareModal('text').text(Event.toText(event));\n\n  modal.iziModal('open');\n}\n\nfunction loadModal() {\n  $.get(chrome.extension.getURL('/views/share-popup.html'), function (popup) {\n    body().append(popup);\n    checkFacebookLoginState();\n  });\n}\n\nfunction handleModalButtons() {\n  var event = shareModal().data('event');\n\n  shareModal('-text').text('\"' + Event.toText(event) + '\"');\n\n  shareModal('-twitter').off('click').on('click', function () {\n    window.open(twitterUrl + Event.toLink(event), '', windowOptions);\n  });\n  shareModal('-facebook').off('click').on('click', function () {\n    confirmPostToFacebook(Event, event);\n  });\n  shareModal('-gplus').off('click').on('click', function () {\n    window.open(gplusUrl(Event.imageUrl(event)), '', windowOptions);\n  });\n}\n\n$(document).on('opened', shareModal().attr('id'), handleModalButtons);"],"sourceRoot":"/source/"}