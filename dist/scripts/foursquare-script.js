"use strict";!function(){function e(){chrome.storage.sync.get("foursquareToken",function(e){e.foursquareToken&&s(e.foursquareToken)})}function n(e,n){var o=t(e,n);return addEventListener("message",o,!1),o}function t(e,n){return function(t){t&&t.data&&t.data.to&&"socialcalendarextension"===t.data.to&&t.data["for"]===e&&n(t.data)}}function o(){l=n("connectFoursquareCallback",a),window.open(v,"",q)}function a(e){removeEventListener("message",l,!1);var n=e.response+"&";n=n.substr(n.indexOf("access_token=")+13),n=n.substr(0,n.indexOf("&")),n=decodeURIComponent(n);var t=n;chrome.storage.sync.set({foursquareToken:t},function(){console.log("Token "+t+" saved"),s(t)})}function s(e){var n=$("#socialcalendarextension-share-modal-foursquare"),t=$("#socialcalendarextension-connect-foursquare");n.removeClass("sce-disabled"),t.hide(),d=e}function r(e,n,t,o){swal({title:"Post in Foursquare",text:"Write what you want to share <small>(in "+t.name+")</small>:",type:"input",showCancelButton:!0,closeOnConfirm:!1,html:!0,inputValue:e.toText(n)},o)}function u(e,n){$.post(k(d,e.id,n),function(t){swal({title:"Nice!",text:"You checked in <strong>"+n+"</strong> at <strong>"+e.name+"</strong> ",type:"success",html:!0}),w().hide()})}function i(e,n){return function(t){return $('<li class="socialcalendarextension-foursquare-li">').html('\n        <span class="sce-f-li-name">'+t.name+'</span>\n        <span class="sce-f-li-location">'+t.location.formattedAddress.join(" - ")+"</span>\n      ").on("click",r.bind(null,e,n,t,function(e){return e!==!1&&(""===e?(swal.showInputError("You need to write something!"),!1):void u(t,e))}))}}function c(e,n){$.get(g(d,n.location),function(t){var o=t.response.venues.map(i(e,n));w().show().find("> ul").html("").append(o)})}var l=(n("connectFoursquare",o),void 0),d=void 0,f="https://foodtruckincubator.github.io/WeRat_Chrome/foursquare-callback.html",h="NCHNPGBJPIRJ44SFBIZYH2CP4G2JYF4OOBMDTYFZQ1L1ZLKD",m="https://foursquare.com/",p="https://api.foursquare.com/v2",w=function(){return $(".socialcalendarextension-foursquare-places")},v=m+"/oauth2/authenticate?client_id="+h+"&response_type=token&redirect_uri="+f,g=function(e,n){return p+"/venues/search?v=20160913&intent=browse&oauth_token="+e+"&near="+encodeURIComponent(n)},k=function(e,n,t){return p+"/checkins/add?v=20160913&oauth_token="+e+"&venueId="+n+"&shout="+t},q="width=500, height=500,left="+(window.outerWidth-500)/2+", top="+(window.outerHeight-500)/2.5;window.checkFoursquareLoginState=e,window.listFoursquarePlaces=c}();
//# sourceMappingURL=foursquare-script.js.map
