"use strict";!function(){function n(n,e){var o=t(n,e);return addEventListener("message",o,!1),o}function t(n,t){return function(e){e&&e.data&&e.data.to&&"socialcalendarextension"===e.data.to&&e.data["for"]===n&&t(e.data)}}function e(t){c=n("connectFoursquareCallback",o(t)),window.open(v,"",q)}function o(n){return function(t){removeEventListener("message",c,!1);var e=t.response+"&";e=e.substr(e.indexOf("access_token=")+13),e=e.substr(0,e.indexOf("&")),e=decodeURIComponent(e);var o=e;chrome.storage.sync.set({foursquareToken:o},function(){console.log("Token "+o+" saved"),l=o,n()})}}function a(n,t,e,o){swal({title:"Post in Foursquare",text:"Write what you want to share <small>(in "+e.name+")</small>:",type:"input",showCancelButton:!0,html:!0,inputValue:n.toText(t)},o)}function r(n,t){w().fadeIn(),m().hide(),$.post(k(l,n.id,t),function(e){w().fadeOut(),swal({title:"Nice!",text:"You checked in <strong>"+t+"</strong> at <strong>"+n.name+"</strong> ",type:"success",html:!0})})}function s(n,t){return function(e){return $('<li class="socialcalendarextension-foursquare-li">').html('\n        <span class="sce-f-li-name">'+e.name+'</span>\n        <span class="sce-f-li-location">'+e.location.formattedAddress.join(" - ")+"</span>\n      ").on("click",a.bind(null,n,t,e,function(n){return n!==!1&&(""===n?(swal.showInputError("You need to write something!"),!1):void r(e,n))}))}}function u(n,t){w().fadeIn(),$.get(g(l,t.location),function(e){w().fadeOut();var o=e.response.venues.map(s(n,t));m().show().find("> ul").html("").append(o)})}function i(n,t){chrome.storage.sync.get("foursquareToken",function(o){return o.foursquareToken?(l=o.foursquareToken,u(n,t)):void swal({title:"Connect at Foursquare",text:"Click in <strong>Ok</strong> to connect with Foursquare first",type:"info",showCancelButton:!0,html:!0,inputValue:n.toText(t)},e.bind(null,u.bind(null,n,t)))})}var c=void 0,l=void 0,d="https://foodtruckincubator.github.io/WeRat_Chrome/foursquare-callback.html",f="NCHNPGBJPIRJ44SFBIZYH2CP4G2JYF4OOBMDTYFZQ1L1ZLKD",h="https://foursquare.com/",p="https://api.foursquare.com/v2",m=function(){return $(".socialcalendarextension-foursquare-places")},w=function(){return $(".socialcalendarextension-loading")},v=h+"/oauth2/authenticate?client_id="+f+"&response_type=token&redirect_uri="+d,g=function(n,t){return p+"/venues/search?v=20160913&intent=browse&oauth_token="+n+"&near="+encodeURIComponent(t)},k=function(n,t,e){return p+"/checkins/add?v=20160913&oauth_token="+n+"&venueId="+t+"&shout="+e},q="width=500, height=500,left="+(window.outerWidth-500)/2+", top="+(window.outerHeight-500)/2.5;window.tryPostAtFoursquare=i}();
//# sourceMappingURL=foursquare-script.js.map
