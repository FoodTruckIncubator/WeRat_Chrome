{"version":3,"sources":["scripts/facebook-script.js"],"names":["FB","fn","params","callback","callbackFirst","listenerFor","fnFor","event","data","to","console","log","removeEventListener","listener","response","Array","window","postMessage","from","fb","addEventListener","attachEvent","checkFacebookLoginState","tryPostAtFacebook","checkFacebookLoginStateOnly","confirmPostToFacebook","Event","swal","title","text","type","showCancelButton","closeOnConfirm","inputValue","toText","showInputError","postToFacebook","message","privacy","value","error","id","html","loading","fadeIn","fadeOut","status","__Event","__event","scope","bind","$"],"mappings":"AAAA,cAEA,WACE,QAASA,GAAGC,EAAIC,EAAQC,EAAUC,GAkBhC,QAASC,GAAYC,GACnB,MAAO,UAAUC,GACVA,GAAUA,EAAMC,MAASD,EAAMC,KAAKC,IAAwB,4BAAlBF,EAAMC,KAAKC,IACtDF,EAAMC,KAAND,SAAmBD,IAEvBI,QAAQC,IAAIJ,EAAMC,MAElBI,oBAAoB,UAAWC,GAAU,GAEzCV,EAASI,EAAMC,KAAKM,YA1BnBZ,IAAQA,MACPA,YAAkBa,SAAQb,GAAUA,IAE1Cc,OAAOC,aACLC,KAAM,0BACNC,IAAMlB,GAAIA,EAAIC,OAAQA,GACtBE,gBAAiBA,GAChB,IAEH,IAAIS,GAAWR,EAAYJ,EAEvBe,QAAOI,iBACTA,iBAAiB,UAAWP,GAAU,GAEtCQ,YAAY,YAAaR,GAgC7B,QAASS,GAAwBnB,GAC/BH,EAAG,iBAAkB,KAAMuB,GAE7B,QAASC,GAA4BrB,GACnCH,EAAG,iBAAkB,KAAM,cAG7B,QAASyB,GAAsBC,EAAOnB,GACpCoB,MACEC,MAAO,mBACPC,KAAM,gCACNC,KAAM,QACNC,kBAAkB,EAClBC,gBAAgB,EAChBC,WAAYP,EAAMQ,OAAO3B,IACxB,SAAU0B,GACX,MAAIA,MAAe,IAEA,KAAfA,GACFN,KAAKQ,eAAe,iCACb,OAETC,GAAeH,MAGnB,QAASG,GAAeP,GACtB7B,EAAG,OAAQ,WAAY,QACrBqC,QAASR,EACTS,SAAWC,MAAO,UAChB,SAAUzB,GACRA,IAAaA,EAAS0B,MACxBb,MACEC,MAAO,QACPC,KAAM,6DAA+Df,EAAS2B,GAAK,uCACnFX,KAAM,UACNY,MAAM,KAGRhC,QAAQ8B,MAAM,mBAAoB1B,GAClCa,MACEC,MAAO,wBACPE,KAAM,aAMd,QAASP,GAAkBG,EAAOnB,GAChCoC,IAAUC,SACV5C,EAAG,iBAAkB,KAAM,SAAUc,GACnC6B,IAAUE,UACc,cAApB/B,EAASgC,OACXrB,EAAsBC,GAASqB,QAASxC,GAASyC,SAEjDrB,MACEC,MAAO,sBACPC,KAAM,8DACNC,KAAM,OACNC,kBAAkB,EAClBW,MAAM,GACL,WACD1C,EAAG,UAAYiD,MAAO,oCAAsC1B,EAAkB2B,KAAK,KAAMxB,EAAOnB,IAAQ,OA5EhH,GAMIoC,GAAU,WACZ,MAAOQ,GAAE,oCA2EXnC,QAAOM,wBAA0BA,EACjCN,OAAOQ,4BAA8BA,EACrCR,OAAOO,kBAAoBA,EAC3BP,OAAOhB,GAAKA","file":"scripts/facebook-script.js","sourcesContent":["'use strict';\n\n(function () {\n  function FB(fn, params, callback, callbackFirst) {\n    if (!params) params = [];\n    if (!(params instanceof Array)) params = [params];\n\n    window.postMessage({\n      from: 'socialcalendarextension',\n      fb: { fn: fn, params: params },\n      callbackFirst: !!callbackFirst\n    }, '*');\n\n    var listener = listenerFor(fn);\n\n    if (window.addEventListener) {\n      addEventListener('message', listener, false);\n    } else {\n      attachEvent('onmessage', listener);\n    }\n\n    function listenerFor(fnFor) {\n      return function (event) {\n        if (!event || !event.data || !event.data.to || event.data.to !== 'socialcalendarextension') return;\n        if (event.data.for !== fnFor) return;\n\n        console.log(event.data);\n\n        removeEventListener('message', listener, false);\n\n        callback(event.data.response);\n      };\n    }\n  }\n\n  var postButton = function postButton() {\n    return $('#socialcalendarextension-share-modal-facebook');\n  };\n  var connectButton = function connectButton() {\n    return $('#socialcalendarextension-connect-facebook');\n  };\n  var loading = function loading() {\n    return $('.socialcalendarextension-loading');\n  };\n\n  function statusChangeCallback(response) {\n    console.log(response);\n    if (response.status === 'connected') {} else {}\n  }\n\n  function checkFacebookLoginState(callback) {\n    FB('getLoginStatus', null, tryPostAtFacebook);\n  }\n  function checkFacebookLoginStateOnly(callback) {\n    FB('getLoginStatus', null, function () {});\n  }\n\n  function confirmPostToFacebook(Event, event) {\n    swal({\n      title: 'Post in Facebook',\n      text: 'Write what you want to share:',\n      type: 'input',\n      showCancelButton: true,\n      closeOnConfirm: false,\n      inputValue: Event.toText(event)\n    }, function (inputValue) {\n      if (inputValue === false) return false;\n\n      if (inputValue === '') {\n        swal.showInputError('You need to write something!');\n        return false;\n      }\n      postToFacebook(inputValue);\n    });\n  }\n  function postToFacebook(text) {\n    FB('api', ['/me/feed', 'POST', {\n      message: text,\n      privacy: { value: 'SELF' }\n    }], function (response) {\n      if (response && !response.error) {\n        swal({\n          title: 'Nice!',\n          text: 'You can check your post <a href=\"https://www.facebook.com/' + response.id + '\" target=\"_blank\">clicking here</a>!',\n          type: 'success',\n          html: true\n        });\n      } else {\n        console.error('error on posting', response);\n        swal({\n          title: 'Something went wrong!',\n          type: 'error'\n        });\n      }\n    });\n  }\n\n  function tryPostAtFacebook(Event, event) {\n    loading().fadeIn();\n    FB('getLoginStatus', null, function (response) {\n      loading().fadeOut();\n      if (response.status === 'connected') {\n        confirmPostToFacebook(Event || __Event, event || __event);\n      } else {\n        swal({\n          title: 'Connect at Facebook',\n          text: 'Click in <strong>Ok</strong> to connect with Facebook first',\n          type: 'info',\n          showCancelButton: true,\n          html: true\n        }, function () {\n          FB('login', [{ scope: 'public_profile,email,user_posts' }], tryPostAtFacebook.bind(null, Event, event), true);\n        });\n      }\n    });\n  }\n\n  window.checkFacebookLoginState = checkFacebookLoginState;\n  window.checkFacebookLoginStateOnly = checkFacebookLoginStateOnly;\n  window.tryPostAtFacebook = tryPostAtFacebook;\n  window.FB = FB;\n})();"],"sourceRoot":"/source/"}